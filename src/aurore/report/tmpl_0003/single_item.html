{% macro single_item(item) %}
<div class="card shadow-sm my-3 gallery-item" >
    <details>
    <summary class="card-header"><code>{{ item.attrib['id'] }}</code>
        <h5 class="card-title mb-0">
          {{ item.find("title").text }}
        </h5>
        <p class="card-text">
          {{ item.find("summary").text }}
        </p>
      </summary>

      <div class="collapse show" data-parent="gallery" id="collapse-{{ item.attrib['id'] }}">
        <div class="card-body">
          <pre>{{ item.find("exe").find("cli").text }}</pre>
        </div>
      </div>
  </details>
</div>
{% endmacro %}

{% macro filter_script() %}
<script>
let selectedFilters = [];
const images  = document.getElementsByClassName("gallery-item");
const filters = [...document.querySelectorAll('.filter select')];
const toggles = [...document.querySelectorAll('.filter input')];

var show = function (elem) {
    elem.style.display = 'block';
};
var hide = function (elem) {
    elem.style.display = 'none';
};
var toggleFilter =  function(el,elid) {
    const filter = document.getElementById(elid);
    filter.disabled = !el.checked;
   
    if ("createEvent" in document) {
        var evt = document.createEvent("HTMLEvents");
        evt.initEvent("change", false, true);
        filter.dispatchEvent(evt);
    }
    else
        filter.fireEvent("change");
};

for (const filter of filters) {
    filter.addEventListener('change', function(event) {
        selectedFilters = filters.map(filter => filter.disabled ? '' : filter.value).filter(Boolean);
        console.log(selectedFilters);
        for (const image of images) {
            if (selectedFilters.every(filter => image.classList.contains(filter))) {
                show(image);
            }
            else {hide(image)};
        };
    })
};
</script>
{%endmacro%}